<div class="motor-control">
    <h3>Motor Control (MOSFET)</h3>
    
    <div class="control-buttons">
        <button onclick="controlMotor('on')" class="btn btn-success">Turn ON</button>
        <button onclick="controlMotor('off')" class="btn btn-danger">Turn OFF</button>
    </div>
    
    <div class="rpm-control">
        <label for="rpm-slider">Set RPM (%): <span id="rpm-value">50</span></label>
        <input type="range" id="rpm-slider" min="0" max="100" value="50" 
               oninput="updateRPMDisplay(this.value)">
        <button onclick="setMotorSpeed()" class="btn btn-primary">Set Speed</button>
    </div>
    
    <div id="motor-status" class="status-display">
        Current RPM: <span id="current-rpm">0</span>%
    </div>
</div>

<script>
function updateRPMDisplay(value) {
    document.getElementById('rpm-value').textContent = value;
}

function controlMotor(action) {
    fetch('/control_motor', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({action: action})
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
        loadMotorStatus();
    });
}

function setMotorSpeed() {
    const rpm = document.getElementById('rpm-slider').value;
    fetch('/control_motor', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({action: 'set_speed', rpm: rpm})
    })
    .then(response => response.json())
    .then(data => {
        alert(data.message);
        loadMotorStatus();
    });
}

function loadMotorStatus() {
    fetch('/get_motor_status')
    .then(response => response.json())
    .then(data => {
        if(data.status === 'success') {
            document.getElementById('current-rpm').textContent = data.motor_rpm;
        }
    });
}

// Load status on page load
loadMotorStatus();
</script>
